<header class="justify-sb full-width" *ngIf="this.navigationService.isMobile">
  <div class="align-center">
    <button>
      <a [routerLink]="['/contactbar']" routerLinkActive="router-link-active">
        <mat-icon>arrow_back_ios</mat-icon>
      </a>
    </button>
    <img src="/img/workspace-logo.svg" alt="Logo" />
  </div>

  <img [src]="this.userService.auth.currentUser?.photoURL" alt="this.userService.auth.currentUser?.displayName" />
</header>

<main>
  <section (click)="hideList()">
    <div class="chat-header">
      <div (click)="showProfile()">
        <div class="imageContainer">
          <img [src]="currentReciever?.profilephoto || 'img/profilephoto.png'" alt="" />
          <div class="status-dot" [ngClass]="{ green: currentReciever?.online }"></div>
        </div>

        <span>{{ currentReciever?.fullname }}</span>
      </div>
    </div>

    <section id="chat" class="chat-content">
      @for (message of currentMessages; track $index;let i = $index) {
      <ul [ngClass]="{ change: isUser(message) }">
        @if (message.newDay) {
        <li>
          <app-divider-template [messageData]="message"></app-divider-template>
        </li>
        }

        <li [ngClass]="{ reverse: isUser(message) }" class="messagerow">
          <img class="image" [src]="message?.avatar" alt="" />

          <div [ngClass]="{ messageReverse: isUser(message) }" class="messageContainer">
            <div [ngClass]="{ reverse: isUser(message) }" class="messageData">
              <span>{{ message?.name }}</span>
              <p>{{ message?.time }} Uhr</p>
            </div>
            <div [ngClass]="{ bubbleReverse: isUser(message) }" class="messageBubble">
              <span>{{ message?.message }}</span>
            </div>
          </div>
        </li>
      </ul>
      } @if (isMessagesEmpty()) {
      <section class="startContainer">
        <div class="userContainer">
          <img [src]="currentReciever?.profilephoto" alt="" />
          <span>{{ currentReciever?.fullname }}</span>
        </div>
        <div class="welcomeText">
          @if (!isYou()) {
          <p>
            Diese Unterhaltung findet nur zwischen
            <a href="">&commat;{{ currentReciever?.fullname }} </a>und dir statt.
          </p>
          } @else {
          <p>
            <span> Dieser Raum ist nur f√ºr dich da.</span> Mache dir Notizen, liste deine To-dos auf oder bewahre Links und Dateien
            griffbereit auf. Du kannst hier auch gerne Dinge mit dir selbst besprechen.
          </p>
          }
        </div>
      </section>
      }
    </section>
    <ul [ngClass]="{ show: isClicked }" class="lists">
      @for (object of currentList; track $index) {
      <li (click)="openReciver(object.id)" [ngClass]="{ channelStyle: isChannel }" class="listrow">
        <div *ngIf="!isChannel" class="imageContainer">
          <img [src]="object?.profilephoto" alt="" />
          <div *ngIf="!isChannel" class="status-dot" [ngClass]="{ green: object?.online }"></div>
        </div>
        <img class="tag" *ngIf="isChannel" src="./img/tag.svg" alt="" />
        <div>
          <span>{{ object?.fullname || object?.name }}</span>
        </div>
      </li>
      }
    </ul>
    <div class="textContainer">
      <div>
        <textarea
          (input)="getList()"
          (keyup.enter)="input.trim() && sendMessage()"
          [(ngModel)]="input"
          placeholder="Nachricht an {{ currentReciever?.fullname }}"
        ></textarea>
        <div>
          <div class="left">
            <button><img class="smiley" src="./img/smiley.svg" alt="" /></button>
            <button (click)="toggleList($event)">
              <img class="at" src="./img/at.svg" alt="" />
            </button>
          </div>
          <button [disabled]="input.trim() == ''" (click)="sendMessage()" class="right">
            <mat-icon class="hover-dark-purple-to-medium">send</mat-icon>
          </button>
        </div>
      </div>
    </div>
  </section>
</main>
